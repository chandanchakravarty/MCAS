@using MCAS.Web.Objects.Resources.ClaimProcessing;
@using MCAS.Web.Objects.CommonHelper
@{
    
    ViewBag.Title = "TransactionEditor";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var imagePath = Url.Content("~/Images/ajax-loader.gif");
}
<link href="@Url.Content("~/Content/jquery-ui.css")" rel="Stylesheet" media="screen" />
<link href="@Url.Content("~/Content/themes/base/jquery.ui.all.css")" rel="stylesheet" type="text/css" />
<link href='@Url.Content("~/Content/jquery.dataTables.min.css")' rel="stylesheet" type="text/css" />
<style type="text/css">
    #TransactionEditor > div > div:nth-child(1) > div > table tr:hover
    {
        cursor: pointer;
    }
    
    #ajaxSpinnerContainer
    {
        height: 11px;
    }
    #ajaxSpinnerImage
    {
        display: none;
    }
    
    .ajax-loader
    {
        position: absolute;
        left: 50%;
        top: 50%;
        margin-left: -32px;
        margin-top: -32px;
        display: block;
        z-index: 999999999999999;
    }
</style>
<script src="@Url.Content("~/Scripts/jquery-2.1.0.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/globalize/globalize.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/globalize/cultures/globalize.culture.en-GB.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-v1.10.3.js")" type="text/javascript"></script>
<script src='@Url.Content("~/Scripts/jquery.dataTables.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/Scripts/fnReloadAjax.js")' type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/angular.min.js")" type="text/javascript"></script>
<div class="dashboard-wrapper">
    <div class="container" id="reg3">
        <div class="row page-title" id="reg">
            <div class="col-lg-12" id="reg2" style="background-color: white;">
                <h2>
                    Login Audit
                </h2>
                <ul class="breadcrumb">
                    <li>Login Audit Details</li>
                    <li>Search Screen</li>
                </ul>
            </div>
        </div>
        <hr />
        <div id="testdiv">
        </div>
        <div>
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="panel panel-secondary">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <i class="icon-keyboard"></i>Login Audit Enquiry</h3>
                            <div id="expanddiv" class="SearchCriteriaClose">
                            </div>
                        </div>
                        <div class="panel-body" id="searchdiv" style="display: none" data-ng-app="Loginapp" data-ng-controller="LoginAuditControl">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label for="" class="col-sm-3 control-label">
                                            User Id :</label>
                                        <div class="col-sm-9">
                                            <select class="form-control" id="ddlUserId">
                                                <option value="">[Select...]</option>
                                                <option data-ng-repeat="t in userList" value="{{t.UserId}}">{{t.UserId}}</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-9">
                                            <input type="button" class="btn btn-info" value="Search" id="btnSearch" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row" id="toprow">
            <div class=" row col-lg-12">
                <h4 class="text-info" style="text-align: center">
                    Search Results</h4>
            </div>
        </div>
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="TranDiv">
            <div>
                <div class="container">
                    <div class="col-lg-12">
                    </div>
                    <hr />
                    <div class="panel-body">
                        <div class="col-lg-12">
                            <div class="table-responsive">
                                <div id="ajaxSpinnerContainer">
                                    <img alt="" src="../../Images/ajax-loader.gif" id="ajaxSpinnerImage" class="ajax-loader" />
                                </div>
                                <table id="LogTable" class="table table-striped table-hover" border="0" cellpadding="0" cellspacing="0">
                                    <thead>
                                        <tr style="text-align: left; font-weight: bold; text-transform: capitalize; background-color: #C6C6C6;">
                                            <td style="width: 30%; word-break: break-all;">
                                                UserId
                                            </td>
                                            <td style="width: 35%; word-break: break-all;">
                                                LoggedIn Time
                                            </td>
                                            <td style="width: 35%; word-break: break-all;">
                                                LoggedOut Time
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div>
                            <br />
                        </div>
                    </div>
                </div>
            </div>
            @{
                <div class="col-lg-12" style="text-align: center">
                    @Html.ActionLink("Export To Excel", "FileDownLoader", "Home", new { Fileformat = "Excel" }, new { target = "_blank", @class = "btn btn-info" })
                    &nbsp;</div>
            }
        </div>
    </div>
</div>
<script type="text/javascript">

    var app = angular.module('Loginapp', [])
    app.controller('LoginAuditControl', function ($scope) {
        $.ajax({
            type: "Get",
            url: '@Url.Action("GetAllUserId", "Home")',
            success: function (data) {
                $scope.userList = data;
                $scope.$apply();
            }
        });

    });
    var table = "";
    $(document).ready(function () {
        $("#btnSearch").click(function () {
            table.api().ajax.reload();
        });

        table = $('#LogTable').dataTable({
            "bProcessing": true,
            "serverSide": true,
            "cache": false,
            "oLanguage": {
                "sSearch": '@MCAS.Web.Objects.Resources.Common.Common.Search',
                "sInfo": "@MCAS.Web.Objects.Resources.Common.Common.Showing _START_ @MCAS.Web.Objects.Resources.Common.Common.to _END_ @MCAS.Web.Objects.Resources.Common.Common.of _TOTAL_ @MCAS.Web.Objects.Resources.Common.Common.entries",
                "sLengthMenu": "@MCAS.Web.Objects.Resources.Common.Common.Show  _MENU_ @MCAS.Web.Objects.Resources.Common.Common.entries",
                "sEmptyTable": "@MCAS.Web.Objects.Resources.Common.Common.sEmptyTable",
                "sInfoEmpty": "@MCAS.Web.Objects.Resources.Common.Common.sInfoEmpty",
                "sProcessing": "<img src='@imagePath' />",
                "oPaginate": {
                    "sNext": '@MCAS.Web.Objects.Resources.Common.Common.Next',
                    "sLast": '@MCAS.Web.Objects.Resources.Common.Common.Last',
                    "sFirst": '@MCAS.Web.Objects.Resources.Common.Common.First',
                    "sPrevious": '@MCAS.Web.Objects.Resources.Common.Common.Previous'
                }
            },
            "bDestroy": true,
            "lengthMenu": [[10, 20, 50, -1], [10, 20, 50, "All"]],
            "ajax": {
                "url": '@Url.Action("GetLoginAuditLogDetails", "Home")',
                "type": "POST",
                data: function (d) {
                    d.UserId = $("#ddlUserId").val()
                }
               ,
                "cache": false
            },
            "aoColumns": [
            { 'sWidth': '30%' },
            { 'sWidth': '35%' },
            { 'sWidth': '35%' }
    ]

        });

    });
</script>
