@using MCAS.Web.Objects.Resources.Common;
@using MCAS.Globalisation;
@model MCAS.Web.Objects.ClaimObjectHelper.ClaimAccidentDetailsModel
@{
    ViewBag.Title = "NewClaimProcessing";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var OrgCat = Model.OrgCategory == null ? "0" : Model.OrgCategory;
}
<style type="text/css">
    .table-responsive
    {
        width: 100%;
        margin-bottom: 15px;
        overflow-y: hidden;
        overflow-x: scroll;
        -ms-overflow-style: -ms-autohiding-scrollbar;
        border: 1px solid #DDD;
        -webkit-overflow-scrolling: touch;
    }
    .dataTables_wrapper
    {
        margin-bottom: 20px;
    }
    .ui-dialog-buttonset
    {
        margin-right: 40%;
    }
    #ajaxSpinnerContainer
    {
        height: 11px;
    }
    #ajaxSpinnerImage
    {
        display: none;
    }
    .ajax-loader
    {
        position: absolute;
        left: 50%;
        top: 50%;
        margin-left: -32px;
        margin-top: -32px;
        display: block;
        z-index: 999999999999999;
    }
    .ui-dialog .ui-dialog-titlebar
    {
        display: none;
    }

</style>

<script src='@Url.Content("~/Scripts/jquery-2.1.0.min.js")' type="text/javascript"></script>
<div id="divLoading" class="Claimloading">
    <p>
        Please wait...<br />
        <img src="@Url.Content("~/Images/ajax-loader.gif")" alt="Loading.." />
    </p>
</div>
<div class="dashboard-wrapper">
    @using (Html.BeginForm("NewClaimProcessing", "ClaimProcessing", FormMethod.Post, new { role = "form", id = "NewClaimRegForm", name = "NewClaimRegForm" }))
    {
        <div id="ajaxSpinnerContainer">
            <img alt="" src="../../Images/ajax-loader.gif" id="ajaxSpinnerImage" class="ajax-loader" />
        </div>
        <div class="container" id="reg3">
            <div class="row page-title" id="reg">
                <div class="col-lg-12" id="reg2" style="background-color: white;">
                    <h2>
                        Claim Registration</h2>
                    <ul class="breadcrumb">
                        <li>New Claim Registration</li>
                        <li>New Claim Registration</li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="dialog">
            <div id="toprow">
                <div class="row">
                    <div class="form-group">
                        <div class="col-lg-12">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <div class="col-lg-12">
                            <div class="form-group">
                                <label class="col-sm-5 control-label">
                                    Organization Category &nbsp;<span class="text-danger">*</span></label>
                                <div class="col-sm-7">
                                    @Html.DropDownListFor(m => m.OrgCategory, new SelectList(Model.OrgCatTypeList, "Lookup_value", "Lookup_desc", "[Select...]"), new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>
<script>

    var do_on_load = function () {

        $(function () {
            $('#dialog').dialog({
                modal: true,
                draggable: false,
                resizable: false,
                show: 'blind',
                hide: 'blind',
                position: 'absolute',
                width: '550',
                height: '150',
                top: '20',
                left: '260',
                open: function (event, ui) {
                    $('#dialog').css('overflow', 'hidden');
                },
                buttons: {
                    "OK": function (a) {
                        debugger;
                        var orgCat = $('#OrgCategory').val();
                        var url = "";
                        if ("0" == $("#OrgCategory").val()) { (alert("Organization Category is required"), a.preventDefault(), !1) }
                        else {
                            debugger;
                            $(this).dialog("close");
                            if (orgCat == "BU" || orgCat == "TR") {
                                debugger;
//                                url = '@Url.Action("ClaimAccidentEditorNew", "ClaimProcessing", new { policyId = 0, claimMode = "New", OrgCat = -1})';
//                                url = url.replace(-1, orgCat);

                                url = '@Url.Action("ClaimAccidentEditorNew", "ClaimProcessing")';
                                url += "?policyId= 0&claimMode=New&OrgCat=" + orgCat;
                                window.location = url;
                            }
                            else {
//                                url = '@Url.ActionEncoded("ClmAccDltPCNTXEditor", "ClaimRegistrationProcessing", new { policyId = 0, claimMode = "New", OrgCat = 1 })';
//                                url = url.replace(1, orgCat);
                                url = '@Url.Action("ClmAccDltPCNTXEditor", "ClaimRegistrationProcessing")';
                                url += "?policyId= 0&claimMode=New&OrgCat=" + orgCat;
                                window.location = url;
                            }
                        }
                    }
                }
            });
        });
    }
    $(document).ready(do_on_load);
    $(window).bind('page:change', do_on_load);

</script>
