@model  IEnumerable<MCAS.Web.Objects.MastersHelper.ClaimOfficerModel>
@{
    ViewBag.Title = "ClaimOfficerDutyRoster";
    Layout = null; 
}

<style type="text/css">
.wrapper {
  -webkit-transition: All linear 0.2s;
  -moz-transition: All linear 0.2s;
  -ms-transition: All linear 0.2s;
  -o-transition: All linear 0.2s;
  transition: All linear 0.2s;
  z-index: -1000;
  background: white;
  min-height: 800px;
  padding: 0px; }
</style> 

    <!-- Main CSS -->
    <link href="@Url.Content("~/Content/import.css")" rel="Stylesheet" media="screen" />
    <!-- Font Awesome CSS -->
    <link href="@Url.Content("~/fonts/font-awesome.css")" rel="stylesheet" type="text/css" />
<script src="../../Scripts/jquery-2.1.0.min.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.validate.min.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.validate.unobtrusive.min.js" type="text/javascript"></script>
<!-- Data tables --> 
<script src="@Url.Content("~/Scripts/jquery.datatables.js")" type="text/javascript"></script>

<!-- Main Container Start -->
<div class="wrapper">
    <!-- Bootstrap Container Start -->
    <div class="container">
        <!-- Page title start -->
        <div class="row page-title">
            <div class="col-lg-12">
                <h2>
                    System Admin</h2>
                <ul class="breadcrumb">
                    <li>Home</li>
                    <li>Claims Officer Details</li>
                </ul>
            </div>
        </div>
        <!-- Page title end -->
        <!-- Row start for sub navigation -->
        <hr />
        <!-- Row End -->
        <!-- Row start -->
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="panel panel-info">
                    <div class="panel-heading clearfix">
                        <i class="icon-check-sign"></i>
                        <h3 class="panel-title">
                            Claims Officer Details</h3>
                    </div>
                    <div class="panel-body">
                        @using (Html.BeginForm("ClaimOfficerDutyRoster", "ClaimProcessing", FormMethod.Post, new { role = "form", @class = "form-horizontal" }))
                        {
                            <input type="hidden" id="hidval" />
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="inputName">
                                            Department</label>
                                        <div class="col-sm-4">
                                            <select name="ddlDeptCode" id="ddlDeptCode" class="col-lg-12 form-control">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="inputName">
                                            Name</label>
                                        <div class="col-sm-4">
                                            <input type="text" name="inputName" id="inputName" class="form-control" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-lg-12 text-center">
                                    <button type="submit" class="btn btn-info"> Search</button>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
        <!-- Row End -->
        <!-- Row Start -->
        <div class="row">
            <div class="col-lg-12 text-center">
                <h4 class="text-info">
                    Search Results</h4>
                <hr />
            </div>
            <div class="col-lg-12">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>
                                    User Group
                                </th>
                                <th>
                                    Name
                                </th>
                                <th>
                                    Department
                                </th>
                                <th>
                                    Last Assignment Date
                                </th>
                                <th>
                                    Type
                                </th>
                                <th>
                                    Claim No.
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                int trid = 1;
                                int rowmatch = 0;
                                var display = "";
                                var counter = "Y";
                                var hidcounter = "";

                                foreach (var item in Model)
                                {
                                    rowmatch += 1;
                                    counter = counter + rowmatch;
                                    hidcounter = "hiddenTranId" + counter;
                                    var transid = item.TranId;
                                <tr group='@(trid)' style="display:@display;">
                                    <td>
                                        @Html.DisplayFor(modelItem => item.UserGroup)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ClaimOfficerName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ddlDeptCode)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.LastAssignmentdate)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.Type)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ClaimNumber)
                                    </td>
                                    <td>
                                        @*@Html.ActionLink("Assign", "AssignClaimOfficerDutyRoster", new { TranId = item.TranId, pageMode = "Assign" }, new { @class = "btn btn-xs btn-warning" })*@
                                        <a href="#" class = "btn btn-xs btn-warning" id="@counter">Assign</a>
                                        <input type="hidden" id ="@hidcounter" value="@transid"/>
                                    </td>
                                </tr>
                                    if (rowmatch > 9)
                                    {
                                        rowmatch = 0;
                                        trid += 1;
                                        display = "none";
                                    }
                                }}
                        </tbody>
                    </table>
                </div>
            </div>
            @{
                decimal count = (decimal)Model.Count() / 10;
                int totalcount = (int)Math.Ceiling(count);
            
                <div class="col-lg-12 text-center">
                    <ul class="pagination no-margin">
                        <li id="liprevious" onclick="Pagination('liprevious');"><a href="#">«</a> </li>
                        @for (int j = 0; j < totalcount; j++)
                        {
                            if (j == 0)
                            { 
                            <li id="li@(j + 1)" class="active" onclick="Pagination('li@(j + 1)');"><a href="#">@(j + 1)</a>
                            </li>
                            }
                            else
                            {
                                if (j > 4)
                                {
                            <li id="li@(j + 1)" style="display: none;" onclick="Pagination('li@(j + 1)');" ><a
                                href="#">@(j + 1)</a></li>
                                }
                                else
                                { 
                            <li id="li@(j + 1)" onclick="Pagination('li@(j + 1)');" ><a href="#">@(j + 1)</a></li>
                                }
                            }
                        }
                        <li id="linext" onclick="Pagination('linext');"><a href="#">»</a> </li>
                    </ul>
                </div>
                <div class="col-lg-12">
                    &nbsp;</div>
            }
        </div>
        <!-- Row End -->
    </div>
    <!-- Bootstrap Container End -->
</div>
<!-- Main Container End -->

<script type="text/javascript">

    $(document).ready(function () {
    $(document).on('focus', ':input', function () {
            $(this).attr('autocomplete', 'off');
        });
               loadDeptList();
    });


    $('#inputName').keypress(function () {
            var n = $(this).id, e = e || event;
            var r = e.keyCode == 32 ? true : /[a-z]+$/i.test(String.fromCharCode(e.keyCode || e.which))
            if (r == false) {
                return false
            } else {
                return r
            }
        });


    function loadDeptList() {
        $.ajax({
            url: '@(Url.Action("FillDeptCodeList"))',
            cache: false,
            success: function (data) {
                $("#ddlDeptCode").empty();
                $.each(data, function (index, optiondata) {
                    $("#ddlDeptCode").append("<option value='" + optiondata.DeptCode + "'>" + optiondata.DeptName + "</option>");
                });
            },
            error: function (reponse) {
                alert("error : " + reponse);
            }
        });
    }
    
       
function Pagination(id)
 {
     var totalcount = Math.ceil(parseFloat(@Model.Count() / 10));
        if (id == "linext") {
            id = "li" + (parseInt($("#oldgroup").val())==totalcount ? totalcount :(parseInt($("#oldgroup").val())+ 1 ));
        }
        if (id == "liprevious") {
            id = "li" + (parseInt($("#oldgroup").val()) == 1 ? 1 : (parseInt($("#oldgroup").val()) - 1));
        }
        var oldgroup_id = $("#oldgroup").val();
        var tabid_id = id.replace("li", "");
        $("#oldgroup").val(tabid_id);
        $("table tr[group=" + oldgroup_id + "]").css("display", "none");
        $("table tr[group=" + tabid_id + "]").css("display", "");
         $('.active').removeClass();
        $('#'+id).addClass("active");

         if(totalcount>0)
        {
          for(i=1;i<=totalcount;i++)
                    {
                     $("#li"+i).css("display", "none");
                    }
            if(tabid_id>1)
            {
                   
                   if(parseFloat( tabid_id)+2 <= parseFloat(totalcount))
                   {
                        for(i=parseFloat( tabid_id==2?3:tabid_id)-2;i<= parseFloat( tabid_id==2?3:tabid_id)+2;i++)
                        {
                            if(i<=totalcount)
                            {
                             $("#li"+i).css("display", "");
                            }
                        }
                    }
                    else
                    {
                        for(i=parseFloat( totalcount)-4;i<= parseFloat( totalcount);i++)
                        {
                           
                             $("#li"+i).css("display", "");
                        }
                    }
            }
             else
            {
           for(i=parseFloat(1);i<= parseFloat( 5);i++)
                        {
                             $("#li"+i).css("display", "");
                        }
            }
        }

    };
  
   String.prototype.contains = function(it) { return this.indexOf(it) != -1; };
    
</script>


<script type="text/javascript">
    $('a').click(function (e) {
        var hid = "#" + "hiddenTranId" + $(this).attr('id');
        var id = ($(hid).val());
        $.ajax({
            url: '@Url.Action("AssignClaimOfficerDutyRoster", "ClaimProcessing")',
            type: 'GET',
            dataType: 'json',
            // we set cache: false because GET requests are often cached by browsers
            // IE is particularly aggressive in that respect
            cache: false,
            data: { TranId: id },
            success: function (returnData) {
                if (returnData) {
                    if (returnData.Data.Type == "TP") {
                        window.parent.document.getElementById('inputTPAssignment').value = returnData.Data.ClaimentOfficerName;
                    }
                    else {
                        window.parent.document.getElementById('inputODAssignment').value = returnData.Data.ClaimentOfficerName;
                    }
                    window.parent.CloseDialog();
                }
                else {
                    alert("Error: " + returnData);
                }
            }
        });
    });
</script>