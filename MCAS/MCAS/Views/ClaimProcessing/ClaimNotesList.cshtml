@model IEnumerable<MCAS.Web.Objects.ClaimObjectHelper.ClaimNotesModel>
@using MCAS.Web.Objects.Resources.ClaimProcessing;
@using MCAS.Web.Objects.Resources.Common;
@using MCAS.Web.Objects.CommonHelper
@using MCAS.Globalisation;
@{
    @Html.Hidden("oldgroup", 1)
    var mMCASQueryString = @Html.MCASQueryString(Request.QueryString);
    var lebmode = mMCASQueryString["mode"] != null ? Convert.ToString(mMCASQueryString["mode"]) : "";
    ViewBag.Title = "ClaimNotesList";
    Layout = null;
    var policyid = mMCASQueryString["PolicyId"];
    SecurityPermissions myPemissions = (SecurityPermissions)ViewData["UserPermissions"];
    var Cmode = mMCASQueryString["claimMode"] == null ? "Read" : mMCASQueryString["claimMode"];
    
}
<style type="text/css">
/* Sortable tables */
table.sortable thead {
    background-color:#eee;
    color:#666666;
    font-weight: bold;
    cursor: default;
}   
</style>

<script src="@Url.Content("~/Scripts/sorttable.js")" type="text/javascript"></script>
<div class="panel-body">
    <div class="col-lg-12">
        <div class="table-responsive">
            <table class="table table-striped table-hover sortable">
                <thead>
                    <tr>
                        <th style="width: 20%; padding-left: 9px">
                            @ClaimNotesEditor.NoteDate
                        </th>
                        <th style="width: 15%; padding-left: 9px">
                            @ClaimNotesEditor.NoteTime
                        </th>
                        <th style="width: 20%; padding-left: 9px">
                            @{
                                if ((Convert.ToString(Session["OrganisationType"]).ToLower() == "tx") || (Convert.ToString(Session["OrganisationType"]).ToLower() == "pc"))
                                {
                                @ClaimNotesEditor.TPVehicleNo
                                }
                                else
                                { 
                                @ClaimNotesEditor.ClaimantNames
                                }
                            }
                        </th>
                        <th style="width: 30%; padding-left: 9px;">
                            @ClaimNotesEditor.NotesDescription
                        </th>
                        @if (@myPemissions.Write)
                        {
                            <th class="sorttable_nosort" style="width: 15%">
                                @ClaimNotesEditor.Select
                            </th>
                        }
                    </tr>
                </thead>
                <tbody>
                    @{
                        int trid = 1;
                        int rowmatch = 0;
                        var display = "";

                        foreach (var item in Model)
                        {
                            var url = @Url.Content("~/ClaimProcessing/ClaimNotesEditor") + "?PolicyId=0" + "&AccidentClaimId=" + @item.AccidentId + "&NoteId=" + @item.NoteId + "&claimMode=" + @Cmode + "&ClaimId=" + @item.ClaimId + "&mode=" + @lebmode;
                            rowmatch += 1;
                        <tr group='@(trid)' style="display:@display;">
                            <td>
                                @Html.DisplayFor(modelItem => item.NoteDate)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.NoteTime)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ClaimantNames)
                            </td>
                            <td style="word-break: break-word;">
                                @Html.DisplayFor(modelItem => item.NotesDescription)
                            </td>
                            <td>
                                @if (@myPemissions.Write)
                                {
                                    <a class="btn btn-xs btn-info" href="@url">@Common.Select</a>
                                }
                            </td>
                        </tr>
                                if (rowmatch > 9)
                                {
                                    rowmatch = 0;
                                    trid += 1;
                                    display = "none";
                                }
                        }}
                </tbody>
            </table>
        </div>
    </div>
    @{
        decimal count = (decimal)Model.Count() / 10;
        int totalcount = (int)Math.Ceiling(count);
        <div class="row">
            <div class="clearfix igr col-md-1 text-center">
                <div class="form-group">
                    <a class="btn btn-info" id="Previous">@Common.Previous</a>
                </div>
            </div>
            <div class="col-lg-10 text-center">
                <ul class="pagination no-margin">
                    <li id="liprevious" onclick="Pagination('liprevious');"><a href="#">«</a> </li>
                    @for (int j = 0; j < totalcount; j++)
                    {
                        if (j == 0)
                        { 
                        <li id="li@(j + 1)" class="active" onclick="Pagination('li@(j + 1)');"><a href="#">@(j + 1)</a>
                        </li>
                        }
                        else
                        {
                            if (j > 4)
                            {
                        <li id="li@(j + 1)" style="display: none;" onclick="Pagination('li@(j + 1)');" ><a
                            href="#">@(j + 1)</a></li>
                            }
                            else
                            { 
                        <li id="li@(j + 1)"  onclick="Pagination('li@(j + 1)');" ><a href="#">@(j + 1)</a></li>
                            }
                        }
                    }
                    <li id="linext" onclick="Pagination('linext');"><a href="#">»</a> </li>
                </ul>
            </div>
            <div class="clearfix igr col-md-1 text-center">
                <div class="form-group">
                    <a class="btn btn-info" id="Next">@Common.Next</a>
                </div>
            </div>
        </div>
    }
</div>
<script type="text/javascript">

    $(document).ready(function () {
            setTabActive('NotesTab');
        });

    function Pagination(id) {
         var totalcount = Math.ceil(parseFloat(@Model.Count() / 10));
            if (id == "linext") {
                id = "li" + (parseInt($("#oldgroup").val())==totalcount ? totalcount :(parseInt($("#oldgroup").val())+ 1 ));
            }
            if (id == "liprevious") {
                id = "li" + (parseInt($("#oldgroup").val()) == 1 ? 1 : (parseInt($("#oldgroup").val()) - 1));
            }
            var oldgroup_id = $("#oldgroup").val();
            var tabid_id = id.replace("li", "");
            $("#oldgroup").val(tabid_id);
            $("table tr[group=" + oldgroup_id + "]").css("display", "none");
            $("table tr[group=" + tabid_id + "]").css("display", "");
             $('.active').removeClass();
            $('#'+id).addClass("active");

             if(totalcount>0)
            {
              for(i=1;i<=totalcount;i++)
                        {
                         $("#li"+i).css("display", "none");
                        }
                if(tabid_id>1)
                {
                   
                       if(parseFloat( tabid_id)+2 <= parseFloat(totalcount))
                       {
                            for(i=parseFloat( tabid_id==2?3:tabid_id)-2;i<= parseFloat( tabid_id==2?3:tabid_id)+2;i++)
                            {
                                if(i<=totalcount)
                                {
                                 $("#li"+i).css("display", "");
                                }
                            }
                        }
                        else
                        {
                            for(i=parseFloat( totalcount)-4;i<= parseFloat( totalcount);i++)
                            {
                           
                                 $("#li"+i).css("display", "");
                            }
                        }
                }
                 else
                {
               for(i=parseFloat(1);i<= parseFloat( 5);i++)
                            {
                                 $("#li"+i).css("display", "");
                            }
                }
            }
             setTabActive('NotesTab');    
        }
        sorttable.sort_alpha = function(a,b) { return a[0].localeCompare(b[0]); }
</script>
