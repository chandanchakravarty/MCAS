@using System;
@using System.Globalization;
@using MCAS.Web.Objects.Resources.ClaimProcessing;
@using MCAS.Web.Objects.Resources.Common;
@model MCAS.Web.Objects.CommonHelper.SearchCriteria
@{
    ViewBag.Title = "JobScheduleEnquiry";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var caller = "";
    if (Request.QueryString["claimMode"] != null)
    {
        caller = Request.QueryString["claimMode"].ToString();
    }
    var SubMenu = "";
    @Html.Hidden("oldgroup", 1)
}
<style type="text/css">
    .form-horizontal .control-label
    {
        text-align: left;
    }
    td
    {
        word-break: break-all;
    }
    input[type=text], textarea
    {
        text-transform: capitalize;
    }
</style>
<link href="@Url.Content("~/Content/jquery-ui.css")" rel="Stylesheet" media="screen" />
<script src="@Url.Content("~/Scripts/jquery-2.1.0.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/angular.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/McasWeb.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
    PageModel = @(Html.Raw(Json.Encode(Model)));
});
</script>
<div id="divLoading" class="Claimloading">
    <p>
        Please wait...<br />
        <img src="@Url.Content("~/Images/ajax-loader.gif")" alt="Loading..">
    </p>
</div>
<div class="dashboard-wrapper" ng-app="ClaimRegistration">
    <div class="container" ng-controller="JobScheduleEnquiryController" id="reg3" ng-cloak>
        <div class="row page-title" id="reg">
            <div class="col-lg-12" id="reg2" style="background-color: white;">
                <h2>
                    @JobScheduleEnquiry.Enquiry
                </h2>
                <ul class="breadcrumb">
                   <li>@JobScheduleEnquiry.JobScheduleEnquiry_</li>
                    <li>@JobScheduleEnquiry.SearchScreen</li>
                </ul>
            </div>
        </div>
        <hr />
        <div id="testdiv">
        </div>
        <div id="toprow">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="panel panel-secondary">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <i class="icon-keyboard"></i>@JobScheduleEnquiry.SearchJobSchedule</h3>
                            <div id="expanddiv" class="SearchCriteriaExpand">
                            </div>
                        </div>
                        <div class="panel-body" id="searchdiv" @*style="display: none"*@>
                            @using (Html.BeginForm("JobScheduleEnquiry", "ClaimProcessing", FormMethod.Post, new { role = "form", @class = "form-horizontal", id = "JobScheduleEnquiryForm", name = "JobScheduleEnquiryForm" }))
                            {
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label" for="inputJobNo">
                                                @JobScheduleEnquiry.JobNo.</label>
                                            <div class="col-sm-8">
                                                <input type="text" placeholder="Job No." ng-model="model.JobNo" name="inputJobNo"
                                                    len="10" id="inputJobNo" class="form-control" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label" for="inputProcessRefNo">
                                                @JobScheduleEnquiry.ProcessRefNo</label>
                                            <div class="col-sm-8">
                                                <input type="text" placeholder="Process Ref. No." len="10" ng-model="model.ProcessRefNo"
                                                    name="inputProcessRefNo" id="inputProcessRefNo" class="form-control" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label" for="inputScheduleStartDate">
                                                @JobScheduleEnquiry.ScheduleFromDate</label>
                                            <div class="col-sm-8">
                                                <input name="inputScheduleStartDate" len="10" id="inputScheduleStartDate" ng-model="model.ScheduleStartDate"
                                                    placeholder="" class="form-control datepicker" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label" for="inputScheduleToDate">
                                                @JobScheduleEnquiry.ScheduleToDate</label>
                                            <div class="col-sm-8">
                                                <input placeholder="" name="inputScheduleToDate" len="10" id="inputScheduleToDate"
                                                    ng-model="model.ScheduleToDate" class="form-control datepicker" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label" for="inputFillJobType">
                                                @JobScheduleEnquiry.JobType</label>
                                            <div class="col-sm-8">
                                                <select name="ddlFillJobType" id="ddlFillJobType" class="col-lg-12 form-control"
                                                    ng-model="model.JobTypedefault" required ng-options='option.Id as option.Text for option in DataFillJobType'>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="form-group">
                                            <label class="col-sm-4 control-label" for="inputFillStatus">
                                                @JobScheduleEnquiry.JobStatus</label>
                                            <div class="col-sm-8">
                                                <select name="ddlFillJobStatus" id="ddlFillStatus" class="col-lg-12 form-control"
                                                    ng-model="model.JobStatusDefault" required ng-options='option.Id as option.Text for option in DataJobStatus'>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="form-group text-center">
                                            <input type="button" class="btn btn-info" data-ng-click="GetPolicyList()" value="@Common.Search" />
                                            <input type="hidden" ng-model="model.claimMode" id="hidclaimMode" />
                                        </div>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
@*            <div id="divLoadingtable" class="Claimloading" ng-show="loading">
                    <p>
                        Please wait...<br />
                        <img src="@Url.Content("~/Images/ajax-loader.gif")" alt="Loading..">
                    </p>
                </div>*@
            <div class="row" ng-show="divDisplay">
                <div class="col-lg-4">                    
                    @Common.Found <b>{{(Claims|MCASWebFilter:query:'JobNo,JobTypedefault,ProcessRefNo,ScheduleStartDate,JobStartDate,JobEndDate,JobStatusDefault').length}} @Common.Outof {{Claims.length}}</b>  @JobScheduleEnquiry.searchresults_
                </div>
                <div class="col-lg-4 text-center">
                    <h4 class="text-info">
                         @JobScheduleEnquiry.SearchResults</h4>
                </div>
                <div class="col-lg-4 text-right">
                    <form class="form-inline">
                    <b> @JobScheduleEnquiry.Search: </b>
                    <input ng-model="query" id="querysearch" ng-change="change()" type="text" placeholder="Search" autofocus="">
                    </form>
                </div>
                <div class="col-lg-12">
                    <hr />
                </div>
                <div id="divLoadingtable" class="Claimloading" ng-show="loading">
                    <p>
                        Please wait...<br>
                        <img src="@Url.Content("~/Images/ajax-loader.gif")" alt="Loading..">
                    </p>
                </div>
                <div class="col-lg-12">
                    <div class="table-responsive" id="dvData">
                        <table class="table table-striped table-hover" ng-table="tableParams" id="Mcastable">
                            <thead>
                                <tr>
                                    <th style="width: 10%" ng-click="orderByField='SNo'; reverseSort = !reverseSort; order('SNo',reverseSort)"
                                        ng-class="sortOrder(reverseSort,'SNo')">
                                        @JobScheduleEnquiry.JobNo
                                    </th>
                                    <th style="width: 15%" ng-click="orderByField='JobTypedefault'; reverseSort = !reverseSort; order('JobTypedefault',reverseSort)"
                                        ng-class="sortOrder(reverseSort,'JobTypedefault')">
                                        @JobScheduleEnquiry.JobType
                                    </th>
                                    <th style="width: 15%" ng-click="orderByField='ProcessRefNo'; reverseSort = !reverseSort; order('ProcessRefNo',reverseSort)"
                                        ng-class="sortOrder(reverseSort,'ProcessRefNo')">
                                        @JobScheduleEnquiry.ProcessRefNo
                                    </th>
                                    <th style="width: 15%" ng-click="orderByField='ScheduleStartDate'; reverseSort = !reverseSort; order('ScheduleStartDate',reverseSort)"
                                        ng-class="sortOrder(reverseSort,'ScheduleStartDate')">
                                        @JobScheduleEnquiry.ScheduleDateTime
                                    </th>
                                    <th style="width: 15%" ng-click="orderByField='JobStartDate'; reverseSort = !reverseSort; order('JobStartDate',reverseSort)"
                                        ng-class="sortOrder(reverseSort,'JobStartDate')">
                                        @JobScheduleEnquiry.JobStartDateTime
                                    </th>
                                    <th style="width: 15%" ng-click="orderByField='JobEndDate'; reverseSort = !reverseSort; order('JobEndDate',reverseSort)"
                                        ng-class="sortOrder(reverseSort,'JobEndDate')">
                                        @JobScheduleEnquiry.JobEndDateTime
                                    </th>
                                    <th style="width: 15%" ng-click="orderByField='JobStatusDefault'; reverseSort = !reverseSort; order('JobStatusDefault',reverseSort)"
                                        ng-class="sortOrder(reverseSort,'JobStatusDefault')">
                                        @JobScheduleEnquiry.JobStatus
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                @{                                    
                                    <tr ng:repeat="item in Claimsfiltered = (Claims|MCASWebFilter:query:'JobNo,JobTypedefault,ProcessRefNo,ScheduleStartDate,JobStartDate,JobEndDate,JobStatusDefault')| offset:currentPage*itemsPerPage | limitTo:itemsPerPage|orderBy:orderByField:reverseSort |filter:query">
                                        <td>
                                            {{item.JobNo}}
                                        </td>
                                        <td>
                                            {{item.JobTypedefault}}
                                        </td>
                                        <td>
                                            {{item.ProcessRefNo}}
                                        </td>
                                        <td>
                                            {{item.ScheduleStartDate}}
                                        </td>
                                        <td>
                                            {{item.JobStartDate}}
                                        </td>
                                        <td>
                                            {{item.JobEndDate}}
                                        </td>
                                        <td>
                                            {{item.JobStatusDefault}}
                                        </td>
                                    </tr>
                                }
                            </tbody>
                            <tfoot>
                                <td colspan="12">
                                    <div class="col-lg-12 text-center">
                                        <ul class="pagination no-margin">
                                            <li ng-class="prevPageDisabled()"><a href ng-click="prevPage()">« @Common.Prev</a> </li>
                                            <li ng-repeat="n in range((Claims|MCASWebFilter:query:'JobNo,JobTypedefault,ProcessRefNo,ScheduleStartDate,JobStartDate,JobEndDate,JobStatusDefault'))" ng-class="{active: n == currentPage}"
                                                ng-click="setPage(n)"><a href="#">{{n+1}}</a> </li>
                                            <li ng-class="nextPageDisabled()"><a href ng-click="nextPage()">@Common.Next »</a> </li>
                                        </ul>
                                    </div>
                                </td>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
>
<script type="text/javascript">
    var Tname = {
        "inputScheduleStartDate": function () {
            return "Schedule From Date"
        },
        "inputScheduleToDate": function () {
            return "Schedule To Date"
        }
    };
    var do_on_load = function () {
        $("#sidebar").css("position", "fixed").css("z-index", "1033");
        $("#header").addClass("navbar-fixed-top");
        $("#reg2").css("top", $("#header").height());
//        $("#toprow").css("top", $("#top").height()).css("width", $("#reg3").width()).css("padding-right", "0");
        $("#testdiv").css("height", parseInt($("#reg").height()) + parseInt($("#reg2").height()));
        $(document).on("focus", ":input", function () {
            $(this).attr("autocomplete", "off")
        });
        $.culture = Globalize.culture("en-GB");
        $.validator.methods.date = function (a, b) {
            return this.optional(b) || Globalize.parseDate(a, "dd/MM/yyyy", "en-GB") || Globalize.parseDate(a, "yyyy-mm-dd")
        };
        $(".datepicker").datepicker({
            dateFormat: "dd/mm/yy",
            showStatus: true,
            showWeeks: true,
            currentText: 'Now',
            autoSize: true,
            gotoCurrent: true,
            showAnim: 'blind',
            highlightWeek: true,
            changeMonth: !0,
            changeYear: !0,
            yearRange: "1951:2050",
            onSelect: function (a) {
                $(this).valid()
            }
        });
        $('#querysearch').keypress(function (event) {
            var a = $("#" + this.id).val().length;
            var a = "#" + this.id,
                b = event.type,
                b = b.which ? b.which : event.keyCode;
            if (b == 13) {
                return false;
            }
            else {
                return true;
            }
        });

        $("#inputScheduleStartDate,#inputScheduleToDate").change(function (event) {
            var errMessage = "";
            var dob = $(this).val();
            var pattern = /^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/;
            if (!pattern.test(dob) && $(this).val()!='') {
                errMessage += Tname[this.id]() + " must be in 'dd/mm/yyyy' format.";
                alert(errMessage);
                $(this).val("");
                event.preventDefault();
                return false;
            }
        });
    };
    $(document).ready(do_on_load);
    $(window).bind('page:change', do_on_load);
</script>
