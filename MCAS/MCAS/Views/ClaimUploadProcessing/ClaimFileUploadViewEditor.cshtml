@using MCAS.Web.Objects.CommonHelper
@using MCAS.Web.Objects.Resources.ClaimUploadProcessing;
@using MCAS.Web.Objects.Resources.Common;
@model MCAS.Web.Objects.ClaimObjectHelper.ClaimFileUploadViewEditorModel
@using MCAS.Globalisation
@{
    var caller = "";
    var mMCASQueryString = Html.MCASQueryString(Request.QueryString);
    if (mMCASQueryString["claimMode"] != null)
    {
        caller = mMCASQueryString["claimMode"].ToString();
    }

    var lebmode = "";
    if (mMCASQueryString["mode"] != null)
    {
        lebmode = mMCASQueryString["mode"].ToString();
    }
    ViewBag.Title = "View Claim File Upload Status";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var claimId = @Model.ClaimId;
    SecurityPermissions myPemissions = (SecurityPermissions)ViewData["UserPermissions"];
}
<link href="@Url.Content("~/Content/jquery-ui.css")" rel="Stylesheet" media="screen" />
<style type="text/css">
    .form-horizontal .control-label
    {
        text-align: left;
    }
</style>
<script src="@Url.Content("~/Scripts/jquery-2.1.0.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/globalize/globalize.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/globalize/cultures/globalize.culture.en-GB.js")" type="text/javascript"></script>
<div class="dashboard-wrapper">
    <div class="container">
        <div class="page-title" id="reg">
            <div class="col-lg-12" id="reg2" style="background-color: white; position: fixed;z-index: 1;">
                <hr/>
                <h2>
                    @ClaimFileUploadViewEditor.Upload
                </h2>
                <ul class="breadcrumb">
                    <li>@ClaimFileUploadViewEditor.ClaimUpload</li>
                    <li>@ClaimFileUploadViewEditor.ViewClaimFileUploadStatus</li>
                </ul>
            </div>
            <div style="position: relative!important">
            @Html.Action("_ClaimDetails", "ClaimProcessing", new { claimMode = @caller })
        </div>
        </div>
        <hr />
        
        <div class="row" id="toprow">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="panel panel-info">
                    <div class="panel-heading clearfix">
                        <i class="icon-check-sign"></i>
                        <h3 class="panel-title">
                            @ClaimFileUploadViewEditor.ViewTACFileUploadStatus</h3>
                    </div>
                    <hr style='font-weight: bold' />
                    <div class="panel-body" id="DivClaimFileUploadViewEditor">
                        @using (Html.BeginForm("ClaimFileUploadViewEditor", "ClaimUploadProcessing", FormMethod.Post, new { claimMode = @caller, enctype = "multipart/form-data", role = "form", @class = "form-horizontal", id = "ClaimFileUploadViewEditor" }))
                        {
                            <div style="color: Red; font-weight: bold;" class="has-error">
                                <p id="SuccessMsg" align="center">
                                @Html.HiddenFor(m => m.claimode, new { @Value=@caller})
                                    @if (@ViewData["SuccessMsg"] != null)
                                    {
                                        @ViewData["SuccessMsg"]
                                    }
                                </p>
                            </div>
                            <div class="form-group">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="Uploadrefno">
                                            @ClaimFileUploadViewEditor.UploadRefNo.</label>
                                        <div class="col-sm-8">
                                            @Html.TextBoxFor(m => m.Uploadrefno, new { id = "Uploadrefno", name = "Uploadrefno", @class = "form-control",@len="50" })
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="Uploadstatus">
                                            @ClaimFileUploadViewEditor.UploadStatus</label>
                                        <div class="col-sm-8">
                                            @Html.DropDownListFor(m => m.Uploadstatus, new SelectList(Model.Uploadstatuslist1, "Id", "Text", "Select"), new { id = "Uploadstatus", name = "Uploadstatus", @class = "col-lg-12 form-control" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="TACIPBUS">
                                            @ClaimFileUploadViewEditor.UploadFromDate</label>
                                        <div class="col-sm-8">
                                            @Html.TextBoxFor(m => m.UploadFromDate, new { id = "UploadFromDate", name = "UploadFromDate", @class = "form-control datepicker" })
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label" for="UploadToDate">
                                            @ClaimFileUploadViewEditor.UploadToDate</label>
                                        <div class="col-sm-8">
                                            @Html.TextBoxFor(m => m.UploadToDate, new { id = "UploadToDate", name = "UploadToDate", @class = "form-control datepicker" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                                
                            <div class="row">
                                <div class="clearfix igr text-center">
                                    <div class="form-group">
                                        @if (@myPemissions.Read)
                                        {
                                            <a class="btn btn-info" id="btnClear">@Common.Clear</a>
                                            <button type="submit" class="btn btn-info" id="btnSearch">@Common.Search</button>
                                        }
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4">
                                </div>
                                <div class="col-lg-4 text-center">
                                    <h4 class="text-info">
                                        @ClaimFileUploadViewEditor.SearchResults</h4>
                                </div>
                                <div class="col-lg-4 text-right">
                                </div>
                                <div class="col-lg-12">
                                    <hr />
                                </div>
                                @Html.Action("ClaimFileUploadViewList", "ClaimUploadProcessing", new { claimMode = @caller })
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var Tname = {
        UploadFromDate: function () {
            return "Upload From Date"
        },
        UploadToDate: function () {
            return "Upload To Date"
        }
    };
    var do_on_load = function () {
        $("#mini-nav").click(function () {
            $("#toprow").css("width", "auto")
        });
        $(document).on("focus", ":input", function () {
            $(this).attr("autocomplete", "off")
        });
        $.culture = Globalize.culture("en-GB");
        $.validator.methods.date = function (a, b) {
            return this.optional(b) || Globalize.parseDate(a, "dd/MM/yyyy", "en-GB") || Globalize.parseDate(a, "yyyy-mm-dd")
        };
        $(".datepicker").datepicker({
            dateFormat: "dd/mm/yy",
            showStatus: !0,
            showWeeks: !0,
            currentText: "Now",
            autoSize: !0,
            gotoCurrent: !0,
            showAnim: "blind",
            highlightWeek: !0,
            changeMonth: !0,
            changeYear: !0,
            yearRange: "1951:2050",
            onSelect: function (a) {
                $(this).valid()
            }
        });
        $("#btnClear").click(function () {
            $("input[type=text]").val("");
            $("select").prop("selectedIndex", 0);
            $("span.field-validation-error").removeClass("field-validation-error").addClass("field-validation-valid");
            $("#SuccessMsg").empty()
        });
        $("#querysearch").keypress(function () {
            $("#" + this.id).val();
            var a = event.type,
            a = a.which ? a.which : event.keyCode;
            return 13 == a ? !1 : !0
        });
//        $("#UploadFromDate,#UploadToDate").change(function (a) {
//            var b = "",
//            c = $(this).val();
//            if (!/^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/.test(c)) return b += Tname[this.id]() + " must be in 'dd/mm/yyyy' format.", alert(b), $(this).val(""), a.preventDefault(), !1
        //        });

            $("#UploadFromDate,#UploadToDate").change(function (event) {
                    var errMessage = "";
                    var txtVal = $(this).val();
                    if (txtVal != "") {
                        //var pattern = /^([0-9]{2})\/([0-9]{2})\/([0-9]{4})$/;
                        var pattern=/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d$/;
                        if (!pattern.test(txtVal)) {
                            errMessage += Tname[this.id]() + " must be in 'dd/mm/yyyy' format.";
                            alert(errMessage);
                            $(this).val("");
                            event.preventDefault();
                            return false;
                        }
                    }
                });
        
    };
    $(document).ready(do_on_load);
    $(window).bind("page:change", do_on_load);
</script>